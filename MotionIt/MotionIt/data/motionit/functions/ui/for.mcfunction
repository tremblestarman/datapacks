# entity selection
scoreboard players set step var 0
execute as @a[nbt={SelectedItem:{tag:{entityselector:1b}}},scores={rightclick=1..},tag=!positionSelecting] at @s positioned ~ ~1.67 ~ positioned ^ ^ ^0.1 run function motionit:ui/raycast
execute as @a[nbt=!{SelectedItem:{tag:{entityselector:1b}}}] run function motionit:ui/clear

# process
execute as @a[tag=motionProccessing] run tellraw @s ["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"]
execute as @e[tag=entitySelected] run tellraw @a ["",{"text":"ox = "},{"score":{"name":"@s","objective":"ox"},"color":"red"},{"text":", oy = "},{"score":{"name":"@s","objective":"oy"},"color":"blue"},{"text":", oz = "},{"score":{"name":"@s","objective":"oz"},"color":"green"}]
execute as @e[tag=entitySelected,tag=positionSelected] run tellraw @a ["",{"text":"tx = "},{"score":{"name":"@s","objective":"tx"},"color":"red"},{"text":", ty = "},{"score":{"name":"@s","objective":"ty"},"color":"blue"},{"text":", tz = "},{"score":{"name":"@s","objective":"tz"},"color":"green"}]
execute as @e[tag=entitySelected,tag=positionSelected] run tellraw @a ["",{"text":"m0 = "},{"score":{"name":"@s","objective":"m0"},"color":"red"},{"text":", m1 = "},{"score":{"name":"@s","objective":"m1"},"color":"blue"},{"text":", m2 = "},{"score":{"name":"@s","objective":"m2"},"color":"green"}]
execute as @e[tag=entitySelected] run tellraw @a ["",{"text":"t = "},{"score":{"name":"@s","objective":"t"},"color":"yellow"}]
execute as @a[tag=motionProccessing,tag=!positionSelecting] if entity @e[tag=entitySelected,tag=positionSelected] run tellraw @a ["",{"text":"[SelectDestination]","clickEvent":{"action":"run_command","value":"/tag @s add positionSelecting"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"selecting Destination for this entity","color":"yellow"}]}}},{"text":"  "},{"text":"[Calculate]","clickEvent":{"action":"run_command","value":"/execute as @e[tag=entitySelected] run function motionit:calculate"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"calculating Motion of this entity","color":"yellow"}]}}},{"text":"  "},{"text":"[Go]","clickEvent":{"action":"run_command","value":"/execute as @e[tag=entitySelected] run function motionit:go"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"assign Motions calculated to this entity","color":"yellow"}]}}},{"text":"  "},{"text":"[Update]","clickEvent":{"action":"run_command","value":"/execute as @e[tag=entitySelected] run function motionit:ui/originupdate"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"updating origin position","color":"yellow"}]}}},{"text":"  "},{"text":"[Back]","clickEvent":{"action":"run_command","value":"/execute as @e[tag=entitySelected] run function motion:ui/originback"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"go Back to origin position of this entity","color":"yellow"}]}}}]
execute as @a[tag=motionProccessing,tag=!positionSelecting] if entity @e[tag=entitySelected,tag=!positionSelected] run tellraw @a ["",{"text":"[SelectDestination]","clickEvent":{"action":"run_command","value":"/tag @s add positionSelecting"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"selecting Destination for this entity","color":"yellow"}]}}},{"text":"  "},{"text":"[Calculate]","color":"gray"},{"text":"  ","color":"none"},{"text":"[Go]","color":"gray","clickEvent":{"action":"run_command","value":"/execute as @e[tag=entitySelected] run function motionit:go"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"assign Motions calculated to this entity","color":"yellow"}]}}},{"text":"  ","color":"none"},{"text":"[Update]","clickEvent":{"action":"run_command","value":"/execute as @e[tag=entitySelected] run function motionit:ui/originupdate"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"updating origin position","color":"yellow"}]}},"color":"none"},{"text":"  ","color":"none"},{"text":"[Back]","clickEvent":{"action":"run_command","value":"/execute as @e[tag=entitySelected] run function motion:ui/originback"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"go Back to origin position of this entity","color":"yellow"}]}},"color":"none"}]
execute as @a[tag=motionProccessing,tag=positionSelecting] run tellraw @p ["",{"text":"[SelectDestination]","color":"gray"},{"text":"  ","color":"none"},{"text":"[Calculate]","color":"gray"},{"text":"  ","color":"none"},{"text":"[Go]","color":"gray","clickEvent":{"action":"run_command","value":"/execute as @e[tag=entitySelected] run function motionit:go"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"assign Motions calculated to this entity","color":"yellow"}]}}},{"text":"  ","color":"none"},{"text":"[Update]","color":"gray"},{"text":"  ","color":"none"},{"text":"[Back]","color":"gray"}]
execute as @e[tag=entitySelected] run tellraw @p ["",{"text":"tick: ","color":"yellow"},{"text":" ","color":"none"},{"text":"[+1]","clickEvent":{"action":"run_command","value":"/scoreboard players add @e[tag=entitySelected] t 1"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"+1","color":"yellow"}]}},"color":"none"},{"text":" ","color":"none"},{"text":"[+5]","clickEvent":{"action":"run_command","value":"/scoreboard players add @e[tag=entitySelected] t 5"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"+5","color":"yellow"}]}},"color":"none"},{"text":" ","color":"none"},{"text":"[+10]","clickEvent":{"action":"run_command","value":"/scoreboard players add @e[tag=entitySelected] t 10"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"+10","color":"yellow"}]}},"color":"none"},{"text":" ","color":"none"},{"text":"[-1]","clickEvent":{"action":"run_command","value":"/scoreboard players remove @e[tag=entitySelected] t 1"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"-1","color":"yellow"}]}},"color":"none"},{"text":" ","color":"none"},{"text":"[-5]","clickEvent":{"action":"run_command","value":"/scoreboard players remove @e[tag=entitySelected] t 5"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"-5","color":"yellow"}]}},"color":"none"},{"text":" ","color":"none"},{"text":"[-10]","clickEvent":{"action":"run_command","value":"/scoreboard players remove @e[tag=entitySelected] t 10"},"hoverEvent":{"action":"show_text","value":{"text":"","extra":[{"text":"-10","color":"yellow"}]}},"color":"none"}]
execute unless entity @e[tag=entitySelected] run tag @a[tag=motionProccessing] remove motionProccessing

# destination position selection
execute as @a[tag=positionSelecting] at @s positioned ^ ^1.67 ^4 align x align y align z run summon minecraft:falling_block ~0.5 ~ ~0.5 {Tags:[postionMark],Team:posMark,Time:0,Glowing:1b,NoGravity:1b,BlockState:{Name:"glass"}}
execute as @a[nbt={SelectedItem:{tag:{entityselector:1b}}},scores={rightclick=1},tag=positionSelecting] as @e[tag=postionMark] run function motionit:ui/posselect